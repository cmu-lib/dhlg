{% if page.mediaplayer == true %}
<script>
$('audio,video').mediaelementplayer();
</script>
{% endif %}

<script src="/assets/js/morse.js"></script>
<script src="{{ site.url }}{{ site.baseurl }}/assets/js/javascript.js"></script>
<script>
  $('.morse').each(function(){
    var str=$(this).text();
    $(this).text(encodeMorse(str));
  });
  {% if page.layout=="landing" %}
  var sidenavwidth=$('#sidenav').parent().outerWidth()-26;
  $('#sidenav').css('width',sidenavwidth);
  $('#toc').css('max-height',$(window).innerHeight()-$('.morse:first-of-type','#sidenav').outerHeight(true)-$('h4:first-of-type','#sidenav').outerHeight(true)-30);
  $(window).scroll(function (){
    var top_of_element = $("#pagetitle").offset().top;
    var bottom_of_element = $("#pagetitle").offset().top + $("#pagetitle").outerHeight();
    var bottom_of_screen = $(window).scrollTop() + $(window).innerHeight();
    var top_of_screen = $(window).scrollTop();
    if ((bottom_of_screen > top_of_element) && (top_of_screen < bottom_of_element)){
      $('#sidenav').css({'position':'relative','top':'unset','bottom':'unset'});
    } else {
      var footertop_of_element = $("#footer").offset().top;
      var footerbottom_of_element = $("#footer").offset().top + $("#footer").outerHeight();
      var viewablefooter=bottom_of_screen-footertop_of_element+30;
      if ((bottom_of_screen > footertop_of_element) && (top_of_screen < footerbottom_of_element)){

        $('#sidenav').css({'position':'fixed','top':'unset','bottom':viewablefooter});
      } else {
        $('#sidenav').css({'position':'fixed','top':'0','bottom':'unset'});
      }
    }
  });
  $('#toc li').each(function(){
    $(this).click(function(){
      $('html, body').animate({
        {% if page.title == "Scholarly Video Projects" %}
        scrollTop: ($('#project_'+$(this).data('projectid')).offset().top)
        {% endif %}
        {% if page.title == "Topics in DH" %}
        scrollTop: ($('#topic_'+$(this).data('topicid')).offset().top)
        {% endif %}
      },500);
      {% if page.title == "Topics in DH" %}
      $('.content','#topics').removeClass('selectedtopic');
      $('li','#toc').removeClass('selectedtocitem');
      $(this).addClass('selectedtocitem');
      $('#topic_'+$(this).data('topicid')).addClass('selectedtopic');
      {% endif %}
    });
  });
  {% endif %}
  {% if page.layout=="page" %}
  {% if page.sidebar == NULL %}
  var contentheight=$('#contents').outerHeight();
  $('#sidemorse').css('height',contentheight);
  var sidemorsecount=Math.ceil(contentheight/850);
  for(i = 0; i == sidemorsecount; i++) {
    var str=encodeMorse('what are dh?');
    $('#sidemorse').append('<p class="morse">'+str+'</p>');
  }
	{% endif %}
  {% endif %}
</script>

{% if page.header.image_fullwidth %}
<script>
    $("#masthead").backstretch("{{ site.urlimg }}{{ page.header.image_fullwidth }}", {fade: 700});
    $("#masthead-with-text").backstretch("{{ site.urlimg }}{{ page.header.image_fullwidth }}", {fade: 700});
</script>
{% endif %}



{% if site.google_analytics_tracking_id %}
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '{{ site.google_analytics_tracking_id }}', 'auto');
  ga('set', 'anonymizeIp', true);
  ga('send', 'pageview');

</script>
{% endif %}